/*! gruntest 2014-06-18 */
!function(a){var b={};b.info="VERSION: 1.0.0 \n AUTHOR: liuping \n A Controller For Modules";var c={executedList:{}},d={initFnName:"init",destroyFnName:"destroy",autoLoad:!0,sourceRoot:""};$BASE={},$BASE.unikey=function(a){for(var b="number"==typeof a?a:16,c="";c.length<b;c+=Math.random().toString(36).substr(2));return c.substr(0,b)},$BASE.trim=function(a){if("string"!=(typeof a).toLowerCase())return a;for(var b=a.length,c=/\s/,d=0;b>d&&c.test(a.charAt(d));d++);if(d>=b)return"";for(var e=b-1;e>=0;e--)if(!c.test(a.charAt(e))){e++;break}return a.slice(d,e)},$BASE.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},$BASE.isWhat=function(a,b){var c=typeof a;if("undefined"==c)return/^undefined$/i.test(b);var d=new RegExp(b,"gi");try{var e=a.constructor.toString();return d.test(e)}catch(f){return/^object$/i.test(c)&&/^null$/i.test(b)}},$BASE.parseObj=function(a,b,c){var d={};b=$BASE.isWhat(b,"object")?b:{};for(var e in a)if(d[e]=a[e],e in b){var f=b[e],g=parseFloat(f);c&&!isNaN(g)&&(f=g),d[e]=f}return d},$BASE.isNode=function(a,b){return a&&"number"==(typeof a.nodeType).toLowerCase()?b?a.nodeType==parseInt(b):!0:!1},$BASE.objLength=function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},$BASE.getTime=function(a,b){var a=a||"/",c=new Date,d=parseInt(b);if(!isNaN(d)){var e=864e5*d;c=new Date(+c+e)}var f=c.getMonth()+1,g=c.getDate(),h=c.getMinutes(),i=c.getHours(),j=c.getSeconds(),k=c.getFullYear();f=f.toString().length<2?"0"+f:f,g=g.toString().length<2?"0"+g:g,i=i.toString().length<2?"0"+i:i,h=h.toString().length<2?"0"+h:h,j=j.toString().length<2?"0"+j:j;var l=[];l.push(k),l.push(f),l.push(g);var m=[];return m.push(i),m.push(h),m.push(j),l.join(a)+" "+m.join(":")},$BASE.extend=function(a,b){var c=function(){};return c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a},$BASE.newClass=function(a,b){var c=b||function(){};if("object"==typeof a)for(var d in a)a.hasOwnProperty(d)&&(c.prototype[d]=a[d]);return c},$BASE.indexOf=function(a,b){return $BASE.isArray(b)?($BASE.indexOf="undefined"!=typeof b.indexOf?function(a,b){return b.indexOf(a)}:function(a,b){for(var c=-1,d=0;d<b.length;d++)if(b[d]===a){c=d;break}return c},$BASE.indexOf(a,b)):!1},$BASE.consoleLog=function(a){console&&console.log&&console.log(a)},$BASE.emptyFn=function(){},$BASE.removeNode=function(a){a.parentNode.removeChild(a)},$BASE.isDefined=function(a,b){a=$BASE.trim(a);var c;if(-1==a.indexOf("."))c=b[a];else{for(var d=a.split("."),e=b,f=0;f<d.length&&(e=e[d[f]],"undefined"!=typeof e);f++);c=e}return!!c};var e=$BASE,f={priorityQueue:{list:[],cbks:{}},historyQueue:[],busyState:{},globalLock:!1,addQueue:function(a,b){var c=e.parseObj({power:0,callBack:function(){}},b||{},!0);f.busyState[a]=!0,f.priorityQueue.list.splice(c.power,0,a),f.priorityQueue.cbks[a]||(f.priorityQueue.cbks[a]=[]),f.priorityQueue.cbks[a].push(c.callBack)},jsTagCreat:function(a){f.globalLock=!0;for(var b=e.parseObj({isAsyn:!0,isClear:!0},a||{});f.priorityQueue.list.length>0;){var c=f.priorityQueue.list.pop(),g=f.priorityQueue.cbks[c],h=document.createElement("script");h.type="text/javascript",h.defer=b.isAsyn,h.src=d.sourceRoot+c,b.isAsyn&&("onreadystatechange"in h?h.onreadystatechange=function(){var a=h.readyState;if("loaded"==a.toLowerCase()||"complete"==a.toLowerCase()){for(var d=0,i=g.length;i>d;d++)g[d](c);delete f.priorityQueue.cbks[c],f.busyState[c]=!1,b.isClear&&e.removeNode(h),f.historyQueue.push(c)}}:h.onload=function(){for(var a=0,d=g.length;d>a;a++)g[a](c);delete f.priorityQueue.cbks[c],f.busyState[c]=!1,b.isClear&&e.removeNode(h),f.historyQueue.push(c)}),document.body.appendChild(h)}0==f.priorityQueue.list.length&&(f.globalLock=!1)},loader:function(a,b){if(!e.isArray(a)){var a=e.trim(a),c=e.parseObj({isAsyn:!0,power:0,isClear:!0,callBack:function(){}},b||{},!0);return-1!=e.indexOf(a,f.historyQueue)?void c.callBack(a):void(f.priorityQueue.cbks[a]?f.addQueue(a,c):(f.addQueue(a,c),f.globalLock||f.jsTagCreat(c)))}for(var d=0;d<a.length;d++)f.loader(a[d],b)}},g=function(){var a={},b={};this.push=function(c,d,f){var g="";if(d.constructor==h)g=d.mName||e.unikey();else{if("string"!=typeof d)throw"MSG pushing error!";g=d}var i="__MSG__"+g,j=f.mName,k={data:c,sender:j,receiver:g},l=b[i]?b[i].length:0;if(!l)return a[i]?a[i].push(k):a[i]=[k],i;for(var m=0;l>m;m++){var n=b[i][m];n&&n(k)}},this.get=function(b){var c="";if(b.constructor==h)c=b.mName;else{if("string"!=typeof b)throw"MSG getting error!";c=b}if(c){var d="__MSG__"+c,e=a[d];return a[d]=[],e&&e.length?e:void 0}},this.addHandler=function(a,c){var d="";if(a.constructor==h)d=a.mName;else{if("string"!=typeof a)throw"MSG adding handler error!";d=a}if(d){var e="__MSG__"+d;b[e]?b[e].push(c):b[e]=[c]}},this.delHandler=function(a,c){var d="";if(a.constructor==h)d=a.mName;else{if("string"!=typeof a)throw"MSG deleting handler error!";d=a}if(d){var e="__MSG__"+d,f=0;if(b[e]&&(f=b[e].length))if(c)for(var g=0;f>g;g++)b[e][g]==c&&b[e].splice(g,0,1);else b[e]=[]}}},h=function(a){var b={};this.skipRecord=function(a,c){a&&(b[a]=!!c)},this.needSkip=function(a){var c=!1;return b.hasOwnProperty(a)&&(c=b[a]),c},this.mName=a,this.rLink=[],this.logList=[],this.interface={},this.__tailState=!1,this.mUsable=!0},i={},j={},k=new g;h.prototype.tailLog=function(a){"undefined"==typeof a&&(a=!0),a&&!this.__tailState&&a&&this.showLog(),this.__tailState=a},h.prototype.log=function(a,b){var c=e.getTime("-"),d="LOG["+(b||"normal")+"]:"+a+" At "+c+"\n";this.__tailState&&e.consoleLog(d),this.logList[this.logList.length]=d},h.prototype.showLog=function(){var a=this.logList.join("");return e.consoleLog(a),a},h.prototype.tools=e,h.prototype.build=function(){if(!this.mUsable)return void this.log('No permission for "building"!',"Error");var a,b={};switch(typeof arguments[0]){case"object":b=arguments[0],a=arguments[1],"string"==typeof arguments[2]&&(arguments[0].hasOwnProperty(arguments[2])?b[arguments[2]]=arguments[0][arguments[2]]:b={});break;case"string":b[arguments[0]]=arguments[1],a=arguments[2];break;default:return void this.log('Illegal param for "building"',"Error")}for(var c in b)if(b.hasOwnProperty(c)){if(this.hasOwnProperty(c)){if(!a){this.log('Repeat define for "'+c+'"',"Error");continue}this.log('Repeat define for "'+c+'"',"Warning")}this[c]="function"==typeof b[c]&&b.constructor!=h?function(){return"process"!=this.__tailState||this.needSkip(c)||this.log("Running:"+(this.mName||"anonymity")+"."+c,"Record"),b[c].apply(this,arguments)}:b[c],this.log('Success define for "'+c+'"',"Success")}return this},h.prototype.mSend=function(a,b){try{k.push(a,b,this),this.log("Sending data from "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error sending from "+this.mName||"anonymity","Error")}},h.prototype.mMonitor=function(a,b){try{k.addHandler(b||this,a),this.log("Adding monitor in "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error monitor in "+this.mName||"anonymity","Error")}},h.prototype.mUnmonitor=function(a,b){try{k.delHandler(b||this,a),this.log("Deleting monitor in "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error unmonitor in "+this.mName||"anonymity","Error")}},h.prototype.interfaceDefine=function(a,b,c){if(arguments.length<2)return void this.log("Param illegal for Interface defining","Error");if(this.interface.hasOwnProperty(a)){if(!c)return void this.log('Repeat interface defining for "'+a+'"',"Error");this.log('Repeat interface defining for "'+a+'"',"Warning")}"string"==typeof b&&(b=[b]);var d=[];for(var e in b)"string"==typeof b[e]?d.push(b[e]):this.log("Illegal interface methods name for defining!","Error");return this.interface[a]=d,this.log('Success defining for interface "'+a+'"',"Success"),d},h.prototype.interfaceCheck=function(a){var b=[];if("string"==typeof a){if(!this.interface.hasOwnProperty(a))return this.log('The interface name of "'+a+'" is not exist!',"Failure"),!1;b=this.interface[a]}else{if(!e.isWhat(a,"array"))return this.log("Illegal params for interface checking!","Error"),!1;b=a}for(var c=b.length,d=[],f=0;c>f;f++)b[f]in this||d.push(b[f]);return d.length?d:!1},h.prototype.require=function(a,b){i[a]?i[a].link.push({state:"off",module:this}):(i[a]={src:b},i[a].link=[{state:"off",module:this}]),-1==e.indexOf(a,this.rLink)&&this.rLink.push(a)},b.modules={},b.define=function(a){a=e.trim(a);var c=new h(a);if(-1==a.indexOf(".")){if(a in b.modules)throw"Repeat define for "+a;b.modules[a]=c}else{for(var d=a.split("."),f=b.modules,g=0;g<d.length-1;g++)f=f[d[g]]=d[g]in f?f[d[g]]:{};f[d.pop()]=c}return c},b.create=function(a,g){a=e.trim(a);var h;if(-1==a.indexOf("."))h=b.modules[a];else{for(var k=a.split("."),l=b.modules,m=0;m<k.length&&(l=l[k[m]],"undefined"!=typeof l);m++);h=l}if(h){if(!c.executedList[a])for(var m=0,n=h.rLink.length;n>m;m++)if(!e.isDefined(h.rLink[m],b.modules))return d.autoLoad?void f.loader(i[h.rLink[m]].src,{callBack:function(){b.create(a,g)}}):(h.log("Rely lost for "+h.rLink[m],"Warning"),!1);return e.isArray(g)||(g=[g]),j[h.mName]=h[d.initFnName]&&h[d.initFnName].apply(h,g),c.executedList[a]=!0,j[h.mName]||!0}if(i[a])return d.autoLoad?void f.loader(i[a].src,{callBack:function(){b.create(a)}}):!1;throw"Invalid Input for "+a},b.destroy=function(a){a&&j[a]&&j[a][d.destroyFnName]&&(j[a][d.destroyFnName](),delete j[a],delete c.executedList[a])},b.options=function(){var a={};switch(arguments.length){case 2:a[arguments[0]]=arguments[1];break;case 1:a=arguments[0];break;default:return!1}return d=e.parseObj(d,a),!0},b.newM=function(a){return new h(a)},a.$M=b}(window);